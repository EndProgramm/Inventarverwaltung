#:kivy 2.0.0
#:import Widget kivy.uix.widget
#:import BoxLayout kivy.uix.boxlayout
#:import Clock kivy.clock.Clock

<AddInv>
    GridLayout:
        cols: 1
        size: root.width, root.height
        GridLayout:
            cols: 3
            padding: 10
            spacing: 10
            Button:
                id: "addConsum"
                text: "Verbrauch"
                on_release:
                    root.manager.current = "addConsum"
                    root.manager.transition.direction = "right"
            Button:
                id: "addUses"
                text: "Gebrauch"
                on_release:
                    root.manager.current = "addUses"
                    root.manager.transition.direction = "right"
            Button:
                id: "showButton"
                text: "Inventar"
                on_release:
                    root.manager.current = "showAll"
                    root.manager.transition.direction = "up"
        Label:
            size_hint: (2.0,2.0)

<AddConsum>
    GridLayout:
        cols: 1
        size: root.width, root.height
        GridLayout:
            cols: 2
            padding: 10
            spacing: 10
            Label:
                text: "Bezeichnung:"
            TextInput:
                multiline: False
            Label:
                text: "Standort:"
            TextInput:
                multiline: False
            Label:
                text: "Bemerkung:"
            TextInput
            Label:
                text: "Menge:"
            TextInput:
                multiline: False
            Button:
                text: "<< zurück"
                on_release:
                    root.manager.current = "addInv"
                    root.manager.transition.direction = "left"
            Button:
                text: "Speichern"
                on_release:
                    root.saveInv()

<AddUses>
    GridLayout:
        cols: 1
        size: root.width, root.height
        GridLayout:
            cols: 2
            padding: 10
            spacing: 10
            Label:
                text: "Bezeichnung"
            TextInput:
                multiline: False
            Label:
                text: "Standort:"
            TextInput:
                multiline: False
            Label:
                text: "Bemerkung:"
            TextInput
            Label:
                text: "Kategorie:"
            Spinner:
                text: "Kategorie"
                values: "Computer", "Mobiliar", "Drucker"
            Label:
                text: "Ausleihbar:"
            CheckBox
            Button:
                text: "<< zurück"
                on_release:
                    root.manager.current = "addInv"
                    root.manager.transition.direction = "left"
            Button:
                text: "Speichern"
                on_release:
                    root.saveInv()

<ShowAll>
    id: showAll
    Table:

<Table>:
    id: table_floor
    orientation: 'vertical'
    padding: (5, 5)
    spacing: 5
    BoxLayout:
        size_hint: 1, 0.05
        orientation: 'horizontal'
        spacing: 5
        TextInput:
            id: suchfeld

            size_hint: 0.3, 1
            size_hint_max_x: 300

            background_color: (1, 1, 1, 0.8)
            multiline: False
            text: 'Suche'

            on_focus: Clock.schedule_once(lambda dt: self.select_all()) if self.focus else None
            on_text_validate:
                root.callback_suche(self.text)
        Button:
            size_hint: 0.1, 1
            size_hint_max_x: 50
            on_release:
                root.callback_suche(suchfeld.text)
        Button:
            size_hint: 0.1, 1
            size_hint_max_x: 50
            text: "Filter"
            on_release:
                root.filter()

    BoxLayout:
        RecycleView:
            viewclass: 'CustomLabel'
            data: root.table_data
            id: table_floor
            RecycleGridLayout:
                id: table_floor_layout
                cols: root.columns
                default_size: (None,250)
                default_size_hint: (1,None)
                size_hint_y: None
                height: self.minimum_height
                spacing: 5

<TableBox>:
    RecycleView:
        viewclass: 'CustomLabel'
        data: root.table_data
        id: table_floor
        RecycleGridLayout:
            id: table_floor_layout
            cols: root.columns
            default_size: (None,250)
            default_size_hint: (1,None)
            size_hint_y: None
            height: self.minimum_height
            spacing: 5

<Popups>
    typ_spinner: typ
    kategorie_spinner: kategorie
    raum_ent: raum
    zustand_spinner: zustand
    anzahl_von_ent: anzahl_von
    anzahl_bis_ent: anzahl_bis
    ausleihbar_spinner: ausleihbar

    GridLayout:
        cols: 1
        size: root.width, root.height
        pos: root.pos
        GridLayout:
            cols: 2
            padding: 10
            spacing: 10
            Label:
                text:"Typ:"
            Spinner:
                id: typ
                text: "kein Filter"
                values: "kein Filter", "Gebrauch", "Verbrauch" #Wenn nicht ausgewählt wird, dann kein Filter
            Label:
                text: "Kategorie:"
            Spinner:
                id: kategorie
                text: "kein Filter"
                values: "kein Filter","Computer", "Mobiliar", "Drucker"
            Label:
                text: "Raum:"
            TextInput:
                id: raum
                multiline: False
            Label:
                text: "Zustand:"
            Spinner:
                id: zustand
                text: "kein Filter"
                values: "kein Filter", "funktionsfähig", "defekt"
            Label:
                text:"Anzahl:"
            BoxLayout:
                orientation: "horizontal"
                cols: 4
                Label:
                    text:"von"
                TextInput:
                    id: anzahl_von
                    multiline: False

                Label:
                    text:"bis"
                TextInput:
                    id: anzahl_bis
                    multiline: False
            Label:
                text: "Ausleihbarkeit:"
            Spinner:
                id: ausleihbar
                text: "kein Filter"
                values: "kein Filter", "ausleihbar", "ausgeliehen"

        Button:
            text: "zurück"
            size_hint: 1, 0.1
            on_release:
                root.popup_close()
        Button:
            text: "speichern"
            size_hint: 1, 0.1
            on_release:
                root.popup_close()
                root.speichern()
            multiline: False

<CustomLabel@Label>:
    bcolor: (1, 1, 1, 1)
    canvas.before:
        Color:
            rgba: root.bcolor
        Rectangle:
            size: self.size
            pos: self.pos
